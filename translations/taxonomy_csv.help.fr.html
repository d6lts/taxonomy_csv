<!-- $Id$ -->
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<p>Ce module permet d'importer des taxinomies, des structures ou de simples listes de termes</a> dans un vocabulaire à partir d'un fichier <a href="http://fr.wikipedia.org/wiki/Comma-separated_values" title="Définition Wikipedia">CSV</a>, d'une url ou d'un texte copié-collé.</p>
<p>Le format csv correspond à une simple liste de valeurs séparées par un séparateur, souvent une virgule(<strong><code>,</code></strong>) ou un point-virgule (<strong><code>;</code></strong>), et des caractères de délimitation, souvent les guillemets (<strong><code>"</code></strong>). Si vous ne savez pas comment créer un fichier CSV, vous pouvez utiliser <a href="http://www.openoffice.org" title="OpenOffice.org">OpenOffice Calc</a> ou un autre tableur pour exporter vos données dans un fichier CSV.</p>
<br />
<p>Pour importer des termes, l'utilisateur doit avoir le <a href="?q=admin/user/permissions#module-taxonomy_csv" title="configurer les permissions de taxonomy_csv">droit d'accès</a> suivant :<br />
  <ul>
    <li>Module taxonomy_csv / Gérer les taxinomies par csv.</li>
  </ul>
Ce droit d'accès est souvent associé avec ceux-ci :
  <ul>
    <li>Module system / accéder aux pages d'administration ;</li>
    <li>Module taxonomy / administrer la classification ;</li>
  </ul>
</p>
<br />

<p>Quatre éléments doivent être paramètrés pour importer les termes.</p>
<br />
<h3>1. Que voulez-vous importer (contenu de la source) ?</h3>
  <p>La source peut être configurée avec le premier groupe d'options. La première colonne indique toujours le nom du terme importé. Vous pouvez indiquer comment les colonnes suivantes doivent être importées.</p>
  <dl>
    <dt>Termes seuls</dt>
    <dd>
      Les termes sont importés comme de simples termes. Les colonnes suivantes sont ignorées. Exemple :<br />
      <ul>
        <li><code>Diamant</code></li>
        <li><code>Or</code></li>
        <li><code>Bois</code></li>
      </ul>
    </dd>
    <dt>Termes (vocabulaire plat)</dt>
    <dd>
      Cette option permet d'importer un ensemble de termes de manière à créer un vocabulaire plat. Tous les éléments du fichier seront importés en tant que termes. Exemple :<br />
      <ul>
        <li><code>Vétements, Arbres, Maisons</code></li>
        <li><code>Paris, Drupal</code></li>
      </ul>
    </dd>
    <dt>Structure hiérarchique ou en tableau d'un terme par ligne</dt>
    <dd>
      Cette option permet de créer la structure d'un vocabulaire (arborescence). Votre fichier peut être écrit selon deux schémas.<br >
      Dans le premier schéma, vous devez indiquer tous les ancêtres de chaque terme. La deuxième colonne sera importée comme un enfant du terme de la première colonne. La troisième colonne sera importée comme un enfant du terme de la deuxième colonne et ainsi de suite. Les lignes peuvent avoir n'importe quel ordre. Exemple:<br />
      <ul>
        <li><code>Animal,Mammifère,Baleine</code></li>
        <li><code>Animal,Mammifère,Singe</code></li>
      </ul>
      Attention : lorsqu'un enfant est ajouté ou mis à jour, la ligne doit contenir tous ses ancêtres. Ainsi, une troisième ligne pourrait être :
      <ul>
        <li><code>Animal,Mammifère,Humain</code></li>
      </ul>
      mais <strong>pas</strong> :
      <ul>
        <li><code>Mammifère,Humain</code></li>
      </ul>
      car dans ce cas, < <code>Mammifère</code> > serait importé comme terme de premier niveau et non comme un enfant du terme < <code>Animal</code> > comme dans la ligne précédente.<br />
      <br />
      Dans le schéma "structure en tableau d'un terme par ligne", vous pouvez importer les termes sans répéter tous les ancêtres si la ligne précédente les contient. Ce mode est très pratique pour importer une structure depuis un tableur. Il permet également de construire facilement une structure et de télécharger un fichier plus léger. Votre hiérarchie peut être présentée de la façon suivante :<br />
      <code><table border="1">
        <tr><td>Monde</td><td></td><td></td><td></td></tr>
        <tr><td></td><td>Asie</td><td></td><td></td></tr>
        <tr><td></td><td></td><td>Japon</td><td></td></tr>
        <tr><td></td><td></td><td></td><td>Tokyo</td></tr>
        <tr><td></td><td></td><td>Corée</td><td></td></tr>
        <tr><td></td><td></td><td></td><td>Séoul</td></tr>
      </table></code>
      <br />
      Ainsi, les premières lignes de votre fichier csv seraient :
      <ul>
        <li><code>Monde</code></li>
        <li><code>,Asie</code></li>
        <li><code>,,Japon</code></li>
        <li><code>,,,Tokyo</code></li>
        <li><code>,,Corée</code></li>
        <li><code>,,,Séoul</code></li>
        <li><code>,Europe</code></li>
        <li><code>,,France</code></li>
        <li><code>,,,Paris</code></li>
      </ul>
      < <code>Paris</code> > sera automatiquement ajouté comme enfant du terme < <code>France</code> >.
      <p>Les lignes peuvent être partielles. Ainsi, la ligne suivante pourrait être :</p>
      <ul>
        <li><code>,,Suisse,Bern</code></li>
      </ul>
      < <code>Suisse</code> > serait alors ajouté comme enfant d'< <code>Europe</code> > et bien sûr < <code>Bern</code> > comme enfant de < <code>Suisse</code> >.
      <p>De la même façon, les lignes ci-dessus peuvent être simplifiées en :</p>
      <ul>
        <li><code>Monde, Asie, Japon, Tokyo</code></li>
        <li><code>,, Corée, Séoul</code></li>
        <li><code>Monde, Europe, France, Paris</code></li>
      </ul>
      Les lignes complètes, avec un seul terme ou partielles peuvent être mélangées, mais l'ordre est pris en compte deux lignes par deux, sauf lorsque toutes les lignes sont complètes. Dans cet exemple, si les cinquième et sixième lignes sont interverties, < <code>Séoul</code> > deviendrait un enfant de < <code>Japon</code> >.
    </dd>
    <dt>Termes liés (termes connexes)</dt>
    <dd>
      Attention : sous Drupal 7, les termes liés ont été supprimés et remplacés par les champs (fields). Cette option est donc disponible seulement avec Drupal 6.<br />
      Cette option permet de créer des liens entre les termes comme les "voir aussi" dans une encyclopédie. La deuxième colonne et les suivantes seront importées en tant que termes connexes du terme de la première colonne. Par exemple, une ligne pourrait être :<br />
      <ul>
        <li><code>Baobab, Madagascar, Fantôme</code></li>
      </ul>
      Ainsi, < <code>Baobab</code> > renverra à < <code>Madagascar</code> > et à < <code>Fantôme</code> >. Une option permet de créer également les sous-relations, en l'occurrence entre < <code>Madagascar</code> > et < <code>Fantôme</code> > (voir ci-dessous).
    </dd>
    <dt>Description du terme</dt>
    <dd>
      La seconde colonne sera importée comme description du terme défini dans la première colonne.Exemple :<br/>
      <ul>
        <li><code>"Baobab","Un arbre africain"</code></li>
      </ul>
    </dd>
    <dt>Poids des termes</dt>
    <dd>
      La seconde colonne sera importée comme poids du terme défini dans la première colonne. Exemple :<br/>
      <ul>
        <li><code>Baobab, 3</code></li>
      </ul>
    </dd>
    <dt>Termes synonymes</dt>
    <dd>
      La deuxième colonne et les suivantes seront importées comme termes synonymes du terme de la première colonne. Exemple :<br />
      <ul>
        <li><code>"Royaume Uni","Grande-Bretagne","Angleterre"</code></li>
      </ul>
    </dd>
    <dt>Taxonomy manager export</dt>
    <dd>
      Ce format est utilisé par <a href="http://drupal.org/project/taxonomy_manager" title="Module Taxonomy manager">Taxonomy manager</a> pour exporter des vocabulaires. Les colonnes sont : identifiant du vocabulaire, identifiant du terme, nom du terme, description du terme, parent 1 de premier niveau, ..., parent n de premier niveau. Example:<br />
      <ul>
        <li><code>"1"; "25"; "Louis XVII"; "Roi de France"; "Louis XVI"; "Marie-Antoinette"</code></li>
      </ul>
      Dans ce format, l'ordre des lignes est important : il est impossible d'attacher un parent à un terme si ce parent n'a pas été importé dans une ligne précédente.<br />
      Lorsqu'un vocabulaire est importé dans un vocabulaire existant, seule l'option "ignorer et créer" peut être utilisée.
    </dd>
  </dl>
  <br />

<h3>2. Où se trouvent les termes à importer ?</h3>
  <p>Vous pouvez importez les termes à partir d'un fichier ou avec une zone de texte. Sélectionnez simplement votre choix. L'adresse du fichier peut être un chemin local ou une url.</p>
  <p>Les paramètres avancés permettent de choisir le séparateur et le délimiteur de champ.</p>
  <br />

<h3>3. Où importer les termes (vocabulaire cible) ?</h3>
  <p>Vous pouvez importer vos termes dans un vocabulaire existant ou en créer un nouveau. Vous pouvez également importer vos termes dans une copie d'un vocabulaire existant.</p>
  <p>Quand vous voulez importer une nouvelle liste dans une taxinomie existante, il est recommandé de procéder en trois étapes de façon à garantir la qualité de l'importation.</p>
  <ul>
    <li>D'abord, vérifier le fichier d'importation en choisissant l'option < <em>Autocréer un nouveau vocabulaire</em> >. Répéter cette étape tant qu'il y a des avertissements et des messages.</li>
    <li>Ensuite, vérifier la fusion entre les nouveaux termes et les termes existants avec l'option < <em>Dupliquer un vocabulaire existant</em> >. Ce choix crée une copie de votre vocabulaire cible et y importe les termes. Les attachements aux nœuds ne sont pas copiés.</li>
    <li>Enfin, vous pouvez importer votre fichier dans le bon vocabulaire avec l'option < <em>Importer dans un vocabulaire existant</em> >. Cela permet de conserver les liens entre les termes et les nœuds.</li>
  </ul>
  <p>Si vous voulez seulement créer un nouveau vocabulaire, le premier choix est suffisant, à moins que vous avez plusieurs fichiers pour un vocabulaire.</p>
  <br />

<h3>4. Comment importer les termes ?</h3>
  <p>La destination peut être configurée avec le second groupe d'options. Vous pouvez définir ce que deviendront les termes existants. Jusqu'à quatre choix sont possibles selon le contenu de la source :</p>
  <dl>
    <dt>Mettre les termes à jour et fusionner avec l'existant</dt>
    <dd>
      Met à jour les termes existants lorsque le nom correspond avec celui des termes importés et fusionne les descriptions, parents, synonymes et termes connexes existants. Les doublons sont supprimés. Ce choix est conseillé si vous voulez conserver un vocabulaire et si vous avez des descriptions, des parents, des synonymes et des termes connexes que vous ne voulez pas perdre.
    </dd>
    <dt>Mettre les termes à jour et remplacer l'existant</dt>
    <dd>
      Met à jour les termes existants si le nom correspond à celui des termes importés, mais remplace les descriptions, les parents, les termes synonymes et connexes existants. Choisissez cette option si vous voulez créer proprement un nouveau vocabulaire sans perdre les termes existants.
      <br />
      Attention : s'il n'y a pas de description, parent, synonyme ou terme connexe, c'est-à-dire si la ligne contient seulement un terme dans la première colonne, cela supprimera l'existant.
    </dd>
    <dt>Ignorer les termes existants et en créer de nouveaux</dt>
    <dd>
      Conserve les termes existants tels qu'ils sont et crée un nouveau terme pour le terme de la première colonne.
      <br />
      Attention : cela peut créer des doublons. Cette option est conseillée seulement si vous êtes sûr que la taxinomie importée contient seulement des termes nouveaux ou si votre vocabulaire autorise les parents multiples.
    </dd>
    <dt>Ignorer tous les termes et en créer de nouveaux</dt>
    <dd>
      Crée un nouveau terme pour chaque terme de la ligne.
    </dd>
  </dl>
  <br />

<h3>Paramètres avancés et conseils</h3>
  <ul>
    <li>
      Pour importer une taxinomie de taille importante lorsqu'il n'est pas possible de modifier les temps et mémoire maximum autorisés par le serveur, il est d'abord conseillé de désactiver certains modules tels que "pathauto" avant l'importation. Les paramètres ne sont pas perdus lorsqu'un module est désactivé - et non désinstallé -.<br />
      Ensuite, vous pouvez utiliser l'importation par fichier. Vous pouvez également réduire le niveau de détail du journal. Enfin, vous pouvez utiliser les paramètres avancés suivants :
      <dl>
        <dt>Désactiver le cache interne</dt>
        <dd>Cette option désactive le cache interne, qui permet l'importation de vocabulaires complexes, avec de multiples parents et certains doublons. Il est inutile pour les listes simples de termes ou les structures en arbre, mais il permet d'afficher des informations sur l'importation. Lorsqu'il est désactivé, aucune information sur le résultat n'est affichée, sauf l'éventuelle première erreur.</dd>
        <dt>Indiquer manuellement le niveau hiérarchique du vocabulaire</dt>
        <dd>Déterminer le niveau hiérarchique d'un vocabulaire nécessite beaucoup de mémoire. Cette option permet donc de le définir manuellement sans vérification.</dd>
        <dt>Désactiver la vérification des lignes</dt>
        <dd>Si vous êtes sûr que le vocabulaire à importer est correctement formaté (utf8, ordre des éléments...), vous pouvez désactiver la vérification. Cette option augmente la vitesse d'importation de 5%.</dd>
      </dl>
    </li>
    <li>
      Attention: la fonction "Lister les termes" par défaut de Drupal peut engendrer des erreurs de mémoire avec les taxinomies de taille importante. Dans ce cas, il est préférable d'utiliser un autre gestionnaire de taxinomies tel que <a href="http://drupal.org/project/taxonomy_manager" title="Module Taxonomy manager">Taxonomy manager</a>.
    </li>
    <li>
      Le séparateur (virgule "<strong><code>,</code></strong>" par défaut, point-virgule "<strong><code>;</code></strong>" ou tabulation) entre les termes peut être choisi dans les paramètres avancés du deuxième groupe d'options. Le séparateur peut également être personnalisé. Il ne peut avoir qu'un seul caractère. Exemple avec le séparateur < <strong><code>¤</code></strong> > :<br />
      <ul>
        <li><code>terme 1¤Ce champ contient des virgules, un point-virgule (;), des guillemets (") et une tabulation, mais il est correctement importé.</code></li>
      </ul>
    </li>
    <li>
      Il est conseillé de protéger les termes par des caractères de délimitation tels que les guillemets (<strong><code>"</code></strong>), notamment s'ils contiennent des caractères non-ASCII ou si les éléments importés, en particulier les descriptions, contiennent le séparateur choisi. Exemple:<br />
      <ul>
        <li><code>"terme 1","Ce champ contient une virgule, mais il sera correctement importé."</code></li>
      </ul>
      Vous pouvez choisir un caractère de délimitation personalisé dans les paramètres avancés du deuxième groupe d'options. Il ne peut avoir qu'un seul caractère ou être absent.
    </li>
    <li>
      Il est conseillé d'utiliser la zone de texte ou un fichier encodé au format utf8 pour éviter les problèmes avec les termes non-ASCII. Si votre serveur ne supporte pas la conversion en utf8, une option permet de la désactiver dans le dernier groupe d'options.
    </li>
    <li>
      Si vous voulez importer à la fois des termes enfants, des descriptions, des poids, des termes synonymes et connexes et une structure hiérarchique, vous devez commencer par le fichier contenant la structure hiérarchique des parents et des enfants. Ainsi, vous devez d'abord importer le fichier des termes enfants en choisissant l'option <em>Noms des termes enfants</em>. Ensuite, vous pouvez importer les autres fichiers en choisissant l'option adéquate et l'une ou l'autre option <em>Mettre à jour...</em>
    </li>
    <li>
      Attention : si 1) le choix de la source <strong>n'est pas</strong> <em>"Ignorer"</em> les colonnes supplémentaires, 2) le fichier ou une ligne dans le fichier contient seulement une colonne et 3) vous choisissez <em>"Mettre à jour et remplacer"</em>, le processus d'importation deviendra un processus de suppression des éléments correspondants (les termes de la première colonne sont toujours conservés ou importés).
    </li>
  </ul>
<p>Un autre module Drupal permet également l'mportation d'une taxinomie par le biais d'un fichier CSV, malgré son nom : <a href="http://drupal.org/project/taxonomy_xml" title="Module Taxonomy XML">taxonomy XML</a>. Son approche est différente. Il utilise un fichier unique conforme à la norme ISO 2788 sur les thésaurus, en l'occurrence un fichier CSV à trois colonnes : <code>premier terme, type de lien, second terme</code>, ou, pour les specialistes, <code>sujet, prédicat, objet</code>. Pour Drupal 4.7 et Drupal 5, <a href="http://drupal.org/project/taxonomy_batch_operations" title="Module Taxonomy batch operations">taxonomy batch operations</a> peut également être utilisé. Vous pouvez donc choisir le module correspondant le mieux à vos besoins.</p>
